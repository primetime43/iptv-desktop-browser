<Window x:Class="DesktopApp.Views.CacheInspectorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cache Inspector" Height="600" Width="1000"
        WindowStartupLocation="CenterOwner"
        Background="#0D1117"
        Foreground="#FFDDE6F2">

    <Window.Resources>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
        </Style>

        <Style x:Key="StatStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="5,2"/>
            <Setter Property="Foreground" Value="#9DB2C7"/>
        </Style>

        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Background" Value="#21262D"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderBrush" Value="#2C333D"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2C333D"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#347DFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderBrush" Value="#2C333D"/>
            <Setter Property="Background" Value="#161B22"/>
        </Style>

        <Style x:Key="TextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#21262D"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderBrush" Value="#2C333D"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5,3"/>
        </Style>

        <Style x:Key="CheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="#9DB2C7"/>
        </Style>

        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="#161B22"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderBrush" Value="#2C333D"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#2C333D"/>
            <Setter Property="AlternatingRowBackground" Value="#1C2329"/>
            <Setter Property="RowBackground" Value="#161B22"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
        </Style>

        <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#21262D"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderBrush" Value="#2C333D"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FFDDE6F2"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,4"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#347DFF"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Cache Inspector &amp; Management"
                   FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

        <!-- Statistics -->
        <GroupBox Grid.Row="1" Header="Cache Statistics" Margin="0,0,0,10" Style="{StaticResource GroupBoxStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="Memory Cache" Style="{StaticResource HeaderStyle}"/>
                    <TextBlock x:Name="MemoryImageCountText" Style="{StaticResource StatStyle}"/>
                    <TextBlock x:Name="MemoryDataCountText" Style="{StaticResource StatStyle}"/>
                </StackPanel>

                <StackPanel Grid.Column="1">
                    <TextBlock Text="Disk Cache" Style="{StaticResource HeaderStyle}"/>
                    <TextBlock x:Name="DiskImageCountText" Style="{StaticResource StatStyle}"/>
                    <TextBlock x:Name="DiskDataCountText" Style="{StaticResource StatStyle}"/>
                </StackPanel>

                <StackPanel Grid.Column="2">
                    <TextBlock Text="Storage" Style="{StaticResource HeaderStyle}"/>
                    <TextBlock x:Name="TotalSizeText" Style="{StaticResource StatStyle}"/>
                    <TextBlock x:Name="CacheDirectoryText" Style="{StaticResource StatStyle}"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Cache Entries List -->
        <GroupBox Grid.Row="2" Header="Cache Entries" Style="{StaticResource GroupBoxStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Filter -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#9DB2C7"/>
                    <TextBox x:Name="FilterTextBox" Width="200"
                             TextChanged="FilterTextBox_TextChanged"
                             ToolTip="Filter by key or data type"
                             Style="{StaticResource TextBoxStyle}"/>
                    <CheckBox x:Name="ShowExpiredCheckBox" Content="Show Expired"
                              Margin="20,0,0,0" VerticalAlignment="Center"
                              Checked="ShowExpiredCheckBox_Changed"
                              Unchecked="ShowExpiredCheckBox_Changed"
                              Style="{StaticResource CheckBoxStyle}"/>
                </StackPanel>

                <!-- Data Grid -->
                <DataGrid Grid.Row="1" x:Name="CacheEntriesGrid"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          Style="{StaticResource DataGridStyle}"
                          SelectionMode="Extended"
                          ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                          CellStyle="{StaticResource DataGridCellStyle}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Key" Binding="{Binding Key}" Width="300"
                                            CanUserSort="True"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding DataType}" Width="120"
                                            CanUserSort="True"/>
                        <DataGridTextColumn Header="Created" Binding="{Binding Created, StringFormat='MMM dd HH:mm'}" Width="100"
                                            CanUserSort="True"/>
                        <DataGridTextColumn Header="Expires" Binding="{Binding ExpiresAt, StringFormat='MMM dd HH:mm'}" Width="100"
                                            CanUserSort="True"/>
                        <DataGridTextColumn Header="Access Count" Binding="{Binding AccessCount}" Width="90"
                                            CanUserSort="True"/>
                        <DataGridTextColumn Header="Size" Binding="{Binding SizeBytesFormatted}" Width="80"
                                            CanUserSort="True"/>
                        <DataGridCheckBoxColumn Header="Expired" Binding="{Binding IsExpired}" Width="60"
                                                CanUserSort="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </GroupBox>

        <!-- Action Buttons -->
        <WrapPanel Grid.Row="3" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="RefreshButton" Content="ðŸ”„ Refresh"
                    Style="{StaticResource ButtonStyle}"
                    Click="RefreshButton_Click"/>
            <Button x:Name="ClearExpiredButton" Content="ðŸ§¹ Clear Expired"
                    Style="{StaticResource ButtonStyle}"
                    Click="ClearExpiredButton_Click"/>
            <Button x:Name="ClearImageCacheButton" Content="ðŸ–¼ï¸ Clear Images"
                    Style="{StaticResource ButtonStyle}"
                    Click="ClearImageCacheButton_Click"/>
            <Button x:Name="DeleteSelectedButton" Content="ðŸ—‘ï¸ Delete Selected"
                    Style="{StaticResource ButtonStyle}"
                    Click="DeleteSelectedButton_Click"/>
            <Button x:Name="OpenCacheFolderButton" Content="ðŸ“ Open Folder"
                    Style="{StaticResource ButtonStyle}"
                    Click="OpenCacheFolderButton_Click"/>
        </WrapPanel>
    </Grid>
</Window>